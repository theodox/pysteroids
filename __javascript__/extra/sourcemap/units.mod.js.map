{
	"version": 3,
	"file": "/Users/stevet/prj/trans/__javascript__/units.mod.js",
	"sources": [
		"/Users/stevet/prj/trans/units.py"
	],
	"sourcesContent": [
		"import random\n\nfrom org import threejs as three\nfrom utils import wrap, AABB\n\n\nclass Unit:\n    def __init__(self):\n        self.geo = None\n        self.momentum = three.Vector3(0, 0, 0)\n\n    def get_position(self):\n        return self.geo.position\n\n    def update(self, t):\n        current_pos = self.geo.position\n        move = three.Vector3().copy(self.momentum)\n        move.multiplyScalar(t)\n        self.geo.matrixWorld.setPosition(current_pos.add(move))\n\n    position = property(get_position)\n\n\nclass Ship(Unit):\n    ROTATE_SPEED = 2.1\n    THRUST = 45\n\n    def __init__(self, keyboard, game):\n        Unit.__init__(self)\n        self.keyboard = keyboard\n\n        self.geo = three.Mesh(\n            three.BoxGeometry(2, 3, 2),\n            three.MeshNormalMaterial()\n        )\n        exhaust = three.Mesh(\n            three.BoxGeometry(1, 2, 1),\n            three.MeshBasicMaterial({'color': 0xffff00})\n        )\n        self.geo.add(exhaust)\n        exhaust.translateY(-2)\n        self.exhaust = exhaust\n        self.momentum = three.Vector3(0, 0, 0)\n        self.keyboard = keyboard\n        self.bbox = AABB(2, 2, self.geo.position)\n        self.game = game\n\n    def thrust(self, amt):\n        thrust_amt = amt * self.THRUST\n        self.momentum = self.momentum.add(self.heading.multiplyScalar(thrust_amt))\n        self.exhaust.visible = amt > 0\n\n    def spin(self, amt):\n        self.geo.rotateZ(amt * self.ROTATE_SPEED * -1)\n\n    def update(self, t):\n        Unit.update(self, t)\n        self.bbox.update(self.position)\n\n    def get_heading(self):\n        # return the local Y axis, since Z is 'up'\n        m = self.geo.matrixWorld.elements\n        return three.Vector3(m[4], m[5], m[6])\n\n    heading = property(get_heading)\n\n\nclass Asteroid(Unit):\n    def __init__(self, radius, pos):\n        Unit.__init__(self)\n        self.radius = radius\n        self.geo = three.Mesh(\n            three.SphereGeometry(self.radius),\n            three.MeshNormalMaterial()\n        )\n        self.geo.position.set(pos.x, pos.y, pos.z)\n        self.bbox = AABB(self.radius * 2, self.radius * 2, self.geo.position)\n        self.momentum = three.Vector3(0, 0, 0)\n\n    def update(self, t):\n        Unit.update(self, t)\n        self.bbox.update(self.position)\n\n\n\nclass Bullet:\n    EXPIRES = 1\n    RESET_POS = three.Vector3(0, 0, 1000)\n    BULLET_SPEED = 50\n\n    def __init__(self):\n        self.vector = three.Vector3(0, 0, 0)\n        self.geo = three.Mesh(\n            three.BoxGeometry(.25, .25, .25),\n            three.MeshBasicMaterial({'color': 0xffffff})\n        )\n        self.lifespan = 0\n        self.momentum = three.Vector3(0, 0, 0)\n        self.reset()\n\n    def update(self, t):\n\n        if self.geo.position.z < 1000:\n            self.lifespan += t\n            if self.lifespan > self.EXPIRES:\n                self.reset()\n                return\n            delta = three.Vector3().copy(self.vector)\n            delta.multiplyScalar(self.BULLET_SPEED * t)\n            delta.add(self.momentum)\n            current_pos = self.geo.position.add(delta)\n            self.geo.position.set(current_pos.x, current_pos.y, current_pos.z)\n            wrap(self.geo)\n\n    def reset(self):\n        self.lifespan = 0\n        self.momentum = three.Vector3(0, 0, 0)\n        self.geo.position.set(self.RESET_POS.x, self.RESET_POS.y, self.RESET_POS.z)\n\n    def get_position(self):\n        return self.geo.position\n\n    position = property(get_position)\n"
	],
	"mappings": "AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA0HA;AA1HA;AAEA;AACA;AAAA;AAGA;AACA;AACA;AACA;AAAA;AAEA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAEA;AAGA;AACA;AACA;AAEA;AACA;AACA;AAIA;AAIA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAEA;AACA;AACA;AACA;AAAA;AAEA;AACA;AAAA;AAEA;AACA;AACA;AAAA;AAEA;AAEA;AACA;AAAA;AAAA;AAEA;AAGA;AACA;AACA;AACA;AAGA;AAEA;AACA;AACA;AAAA;AAEA;AACA;AACA;AAAA;AAAA;AAIA;AACA;AACA;AACA;AAEA;AACA;AAGA;AAEA;AACA;AACA;AAAA;AAEA;AAEA;AAAA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AAAA;AAEA;AACA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA"
}